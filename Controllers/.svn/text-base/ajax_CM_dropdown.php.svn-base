<?PHP 
require_once( "../includes/alex_functions.php"); 
require_once("../includes/dispatch_functions.php");
 	validate_logged_in();
include "ajax_table.php";

function custom_error_handler($a,$b,$c,$d) { return xml_error($a,$b,$c,$d);}

error_reporting(E_ERROR | E_PARSE );
//set_error_handler (xml_error, E_ERROR | E_PARSE);
set_time_limit(10);
$conn = database_connect(); 

$var = json_decode($_GET['request'], true);
 

$sql = "SELECT Dispatch.DispatchID, Dispatch.DispatchID
FROM Customer INNER JOIN ((Dispatch LEFT JOIN Interpreter ON Dispatch.InterpID = Interpreter.InterpID) INNER JOIN Client ON Dispatch.ClientID = Client.ClientID) ON Customer.CustID = Client.CustID
WHERE (" . /*((Interpreter.InterpID)>0) AND*/ " ((Dispatch.Scheduled)< getDate()) AND ((Dispatch.Ended) Is Null)) OR (((Dispatch.CustCanceled) Is Not Null) AND ((Dispatch.Ended) Is Null)) ORDER BY Dispatch.Scheduled ASC;";
   

if (! $DEBUG)
	xmlHeader();
else
	{
	header("Content-type: text/html");
	echo " a - " . $sql;
	}

echo query_to_combo($sql);


?>